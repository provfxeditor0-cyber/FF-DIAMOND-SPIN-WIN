<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>FF Spin & Win</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg: #0f0c29;
            --tile-bg: rgba(255, 255, 255, 0.05);
            --tile-border: 1px solid rgba(255, 255, 255, 0.1);
            --primary: #7000ff;
            --secondary: #00d2ff;
            --gold: #ffd700;
            --neon-glow: 0 0 10px var(--primary), 0 0 20px var(--secondary);
            --active-glow: 0 0 15px #ffd700, 0 0 30px #ffaa00;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Poppins', sans-serif;
            -webkit-tap-highlight-color: transparent;
            user-select: none;
        }

        body {
            background: linear-gradient(135deg, #0f0c29, #302b63, #24243e);
            color: white;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            overflow-x: hidden;
        }

        /* --- HEADER --- */
        .header {
            width: 100%;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(0,0,0,0.2);
            backdrop-filter: blur(10px);
        }

        .coin-box {
            background: rgba(0,0,0,0.5);
            padding: 8px 15px;
            border-radius: 20px;
            border: 1px solid var(--gold);
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: bold;
            color: var(--gold);
        }

        .redeem-btn {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: linear-gradient(135deg, #ff416c, #ff4b2b);
            border: 2px solid white;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 20px;
            color: white;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(255, 75, 43, 0.4);
            transition: transform 0.2s;
            animation: pulse 2s infinite;
        }
        .redeem-btn:active { transform: scale(0.9); }
        .redeem-label { font-size: 10px; position: absolute; bottom: -20px; width: 60px; text-align: center; }

        @keyframes pulse { 0% { box-shadow: 0 0 0 0 rgba(255, 75, 43, 0.7); } 70% { box-shadow: 0 0 0 10px rgba(255, 75, 43, 0); } 100% { box-shadow: 0 0 0 0 rgba(255, 75, 43, 0); } }

        /* --- GAME GRID --- */
        .game-container {
            margin-top: 30px;
            padding: 15px;
            width: 100%;
            max-width: 450px;
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            grid-template-rows: repeat(3, 80px);
            gap: 10px;
            position: relative;
        }

        .tile {
            background: var(--tile-bg);
            border: var(--tile-border);
            border-radius: 12px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            font-weight: bold;
            font-size: 14px;
            position: relative;
            transition: all 0.3s;
        }

        .tile i { font-size: 20px; margin-bottom: 5px; color: var(--secondary); }
        .tile span { color: white; }

        /* Active Tile Animation */
        .tile.active {
            background: var(--gold);
            box-shadow: var(--active-glow);
            border-color: #fff;
            transform: scale(1.1);
            z-index: 2;
        }
        .tile.active i, .tile.active span { color: black; }

        /* Grid Placement Logic */
        .pos-0 { grid-column: 1; grid-row: 1; }
        .pos-1 { grid-column: 2; grid-row: 1; }
        .pos-2 { grid-column: 3; grid-row: 1; }
        .pos-3 { grid-column: 4; grid-row: 1; }
        .pos-4 { grid-column: 4; grid-row: 2; }
        .pos-5 { grid-column: 4; grid-row: 3; }
        .pos-6 { grid-column: 3; grid-row: 3; }
        .pos-7 { grid-column: 2; grid-row: 3; }
        .pos-8 { grid-column: 1; grid-row: 3; }
        .pos-9 { grid-column: 1; grid-row: 2; }

        /* Center Spin Area */
        .spin-center {
            grid-column: 2 / span 2;
            grid-row: 2;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            background: rgba(0,0,0,0.3);
            border-radius: 15px;
            padding: 5px;
        }

        .spin-btn {
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border: none;
            border-radius: 12px;
            color: white;
            font-size: 20px;
            font-weight: 800;
            cursor: pointer;
            box-shadow: 0 5px 20px rgba(112, 0, 255, 0.4);
            transition: all 0.2s;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }
        .spin-btn small { font-size: 10px; font-weight: normal; margin-top: 5px; opacity: 0.8; }
        .spin-btn:active { transform: scale(0.95); box-shadow: 0 2px 10px rgba(112, 0, 255, 0.4); }
        .spin-btn:disabled { background: #333; cursor: not-allowed; box-shadow: none; color: #777; }

        /* Watch Ad Button (Spin) */
        .ad-spin-btn {
            background: linear-gradient(135deg, #f0932b, #f39c12);
            width: 100%; height: 100%;
            border-radius: 12px; border: none; color: white;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            cursor: pointer; font-weight: bold; font-size: 14px;
            animation: bounce 2s infinite;
        }
        @keyframes bounce { 0%, 20%, 50%, 80%, 100% {transform: translateY(0);} 40% {transform: translateY(-5px);} 60% {transform: translateY(-3px);} }

        /* --- BOTTOM ACTIONS --- */
        .bottom-actions {
            margin-top: 20px;
            width: 90%;
            max-width: 400px;
        }

        .watch-coin-btn {
            width: 100%;
            padding: 15px;
            background: #2e3131;
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 12px;
            color: var(--secondary);
            font-weight: bold;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            transition: 0.3s;
        }
        .watch-coin-btn:hover { background: #3e4141; }

        .footer-text {
            margin-top: auto;
            margin-bottom: 20px;
            font-size: 9px;
            color: #888;
            letter-spacing: 1px;
            text-transform: uppercase;
            opacity: 0.7;
        }

        /* --- REDEEM MODAL --- */
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.9); z-index: 100;
            display: flex; justify-content: center; align-items: center;
        }
        .modal-card {
            background: #1a1a2e; width: 90%; max-width: 380px;
            border-radius: 20px; padding: 25px; border: 1px solid var(--primary);
            position: relative; text-align: center;
        }
        .close-modal { position: absolute; top: 15px; right: 15px; color: #777; font-size: 24px; cursor: pointer; }
        
        .redeem-list { margin-top: 20px; display: flex; flex-direction: column; gap: 10px; }
        .redeem-item {
            background: rgba(255,255,255,0.05); padding: 15px; border-radius: 10px;
            display: flex; justify-content: space-between; align-items: center;
            border: 1px solid transparent; cursor: pointer;
        }
        .redeem-item.selected { border-color: var(--gold); background: rgba(255, 215, 0, 0.1); }

        .input-uid {
            width: 100%; padding: 12px; background: #000; border: 1px solid #333;
            color: white; border-radius: 8px; margin-top: 20px; font-family: 'Poppins';
        }
        .submit-redeem {
            width: 100%; padding: 12px; background: linear-gradient(135deg, var(--primary), var(--secondary));
            border: none; color: white; font-weight: bold; border-radius: 8px; margin-top: 15px;
            cursor: pointer;
        }
        .hidden { display: none !important; }

        /* Loading Overlay for Ad Simulation */
        .loader-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #000; z-index: 200; display: flex; flex-direction: column;
            justify-content: center; align-items: center;
        }
        .loader-text { color: white; margin-top: 15px; font-size: 14px; }
        
        /* Ad Container */
        .ad-container {
            width: 100%;
            max-width: 400px;
            margin: 20px auto;
            text-align: center;
            min-height: 50px;
        }
    </style>
</head>
<body>

    <div class="header">
        <div class="coin-box">
            <i class="fas fa-coins"></i>
            <span id="user-coins">0</span>
        </div>
        <div style="position:relative; display:flex; flex-direction:column; align-items:center;">
            <div class="redeem-btn" onclick="openRedeem()">
                <i class="fas fa-gift"></i>
            </div>
            <span class="redeem-label">REDEEM</span>
        </div>
    </div>

    <div class="game-container">
        <div class="tile pos-0" id="tile-0"><i class="fas fa-coins"></i><span>10</span></div>
        <div class="tile pos-1" id="tile-1"><i class="fas fa-coins"></i><span>20</span></div>
        <div class="tile pos-2" id="tile-2"><i class="fas fa-gem"></i><span>5</span></div>
        <div class="tile pos-3" id="tile-3"><i class="fas fa-coins"></i><span>30</span></div>
        
        <div class="tile pos-4" id="tile-4"><i class="fas fa-frown"></i><span>0</span></div>
        
        <div class="tile pos-5" id="tile-5"><i class="fas fa-coins"></i><span>30</span></div>
        <div class="tile pos-6" id="tile-6"><i class="fas fa-coins"></i><span>10</span></div>
        <div class="tile pos-7" id="tile-7"><i class="fas fa-gem"></i><span>2</span></div>
        <div class="tile pos-8" id="tile-8"><i class="fas fa-coins"></i><span>30</span></div>
        
        <div class="tile pos-9" id="tile-9"><i class="fas fa-bomb"></i><span>Loss</span></div>

        <div class="spin-center">
            <button id="spin-btn" class="spin-btn" onclick="spinWheel()">
                SPIN
                <small><span id="spins-left">500</span>/500 Left</small>
            </button>
            <button id="ad-spin-btn" class="ad-spin-btn hidden" onclick="watchAdForSpin()">
                <i class="fas fa-play-circle"></i>
                <span>WATCH AD<br>GET 1 SPIN</span>
            </button>
        </div>
    </div>

    <div class="bottom-actions">
        <button class="watch-coin-btn" onclick="watchAdForCoins()">
            <i class="fas fa-video"></i> Watch Ad to Get 20 Coins
        </button>
    </div>

    <div class="footer-text">FOR FUN</div>

    <div id="redeem-modal" class="modal-overlay hidden">
        <div class="modal-card">
            <span class="close-modal" onclick="closeRedeem()">&times;</span>
            <h3 style="color:var(--secondary)">FF DIAMOND STORE</h3>
            
            <div class="redeem-list">
                <div class="redeem-item" onclick="selectPlan(0, this)">
                    <div><i class="fas fa-coins" style="color:var(--gold)"></i> 1000</div>
                    <div>=</div>
                    <div><i class="fas fa-gem" style="color:#00d2ff"></i> 500</div>
                </div>
                <div class="redeem-item" onclick="selectPlan(1, this)">
                    <div><i class="fas fa-coins" style="color:var(--gold)"></i> 2000</div>
                    <div>=</div>
                    <div><i class="fas fa-gem" style="color:#00d2ff"></i> 1000</div>
                </div>
                <div class="redeem-item" onclick="selectPlan(2, this)">
                    <div><i class="fas fa-coins" style="color:var(--gold)"></i> 5000</div>
                    <div>=</div>
                    <div><i class="fas fa-gem" style="color:#00d2ff"></i> 2800</div>
                </div>
            </div>

            <input type="number" id="ff-uid" class="input-uid" placeholder="Enter FF UID">
            <button class="submit-redeem" onclick="processRedeem()">REDEEM NOW</button>
        </div>
    </div>

    <div id="ad-loader" class="loader-overlay hidden">
        <i class="fas fa-spinner fa-spin" style="font-size:40px; color:var(--secondary)"></i>
        <div class="loader-text">Loading Advertisement...</div>
    </div>

    <script>
        // --- Game Config ---
        const rewards = [
            { type: 'coin', val: 10 },   // 0
            { type: 'coin', val: 20 },   // 1
            { type: 'coin', val: 5 },    // 2
            { type: 'coin', val: 30 },   // 3
            { type: 'loss', val: 0 },    // 4
            { type: 'coin', val: 30 },   // 5
            { type: 'coin', val: 10 },   // 6
            { type: 'coin', val: 2 },    // 7
            { type: 'coin', val: 30 },   // 8
            { type: 'loss', val: 0 }     // 9
        ];

        const PLANS = [
            { cost: 1000, diam: 500 },
            { cost: 2000, diam: 1000 },
            { cost: 5000, diam: 2800 }
        ];

        // --- State ---
        let coins = parseInt(localStorage.getItem('ff_coins')) || 0;
        let spins = parseInt(localStorage.getItem('ff_spins')) || 500;
        let selectedPlanIndex = -1;
        let isSpinning = false;
        let spinCount = 0;
        let adShownCount = 0;

        // --- Initialize Game ---
        function initializeGame() {
            const today = new Date().toDateString();
            const lastReset = localStorage.getItem('ff_last_reset');
            
            if (lastReset !== today) {
                spins = 500;
                localStorage.setItem('ff_last_reset', today);
                localStorage.setItem('ff_spins', spins);
                spinCount = 0;
            }
            
            updateUI();
        }

        // --- Core Functions ---
        function updateUI() {
            document.getElementById('user-coins').innerText = coins;
            document.getElementById('spins-left').innerText = spins;
            localStorage.setItem('ff_coins', coins);
            localStorage.setItem('ff_spins', spins);

            if(spins <= 0) {
                document.getElementById('spin-btn').classList.add('hidden');
                document.getElementById('ad-spin-btn').classList.remove('hidden');
            } else {
                document.getElementById('spin-btn').classList.remove('hidden');
                document.getElementById('ad-spin-btn').classList.add('hidden');
            }
        }

        function spinWheel() {
            if(isSpinning) return;
            if(spins <= 0) return alert("No spins left! Watch ad to get more.");

            isSpinning = true;
            spins--;
            spinCount++;
            updateUI();
            
            // Weighted probabilities
            const weights = [15, 15, 15, 5, 12, 5, 15, 15, 5, 3];
            const totalWeight = weights.reduce((a, b) => a + b, 0);
            let random = Math.floor(Math.random() * totalWeight);
            
            let weightSum = 0;
            let targetIndex = 0;
            for (let i = 0; i < weights.length; i++) {
                weightSum += weights[i];
                if (random < weightSum) {
                    targetIndex = i;
                    break;
                }
            }
            
            // Spin Animation
            let rounds = 3;
            let currentStep = 0;
            let totalSteps = (rounds * 10) + targetIndex;
            let speed = 50;

            function step() {
                document.querySelectorAll('.tile').forEach(t => t.classList.remove('active'));
                
                let actualPos = currentStep % 10;
                document.getElementById(`tile-${actualPos}`).classList.add('active');

                currentStep++;

                if(currentStep <= totalSteps) {
                    if(totalSteps - currentStep < 10) speed += 30;
                    else if(totalSteps - currentStep < 5) speed += 60;
                    
                    setTimeout(step, speed);
                } else {
                    finishSpin(targetIndex);
                }
            }

            step();
        }

        function finishSpin(index) {
            isSpinning = false;
            const reward = rewards[index];
            
            setTimeout(() => {
                if(reward.val > 0) {
                    coins += reward.val;
                    alert(`Congratulations! You won ${reward.val} Coins.`);
                    
                    // ðŸ”¥ ADSTERRA POPUNDER TRIGGER - Every 3rd Spin
                    adShownCount++;
                    if(adShownCount % 3 === 0) {
                        showAdsterraPopunder();
                    }
                } else {
                    alert("Oops! Better luck next time.");
                }
                updateUI();
                document.querySelectorAll('.tile').forEach(t => t.classList.remove('active'));
            }, 300);
        }

        // --- Adsterra Popunder Function ---
        function showAdsterraPopunder() {
            console.log("Showing Adsterra Popunder Ad");
            // This will trigger the Adsterra popunder ad
            // The script loaded from Adsterra will handle the popunder
        }

        // --- Ad Logic ---
        function watchAdForSpin() {
            showLoader("Watching Ad for Spin...", () => {
                spins += 1;
                alert("Ad Watched! You got 1 Free Spin.");
                updateUI();
                
                // Also trigger Adsterra popunder
                showAdsterraPopunder();
            });
        }

        function watchAdForCoins() {
            showLoader("Watching Ad for Coins...", () => {
                coins += 20;
                alert("Ad Watched! You got 20 Coins.");
                updateUI();
                
                // Also trigger Adsterra popunder
                showAdsterraPopunder();
            });
        }

        function showLoader(text, callback) {
            const loader = document.getElementById('ad-loader');
            loader.querySelector('.loader-text').innerText = text;
            loader.classList.remove('hidden');
            
            setTimeout(() => {
                loader.classList.add('hidden');
                if(callback) callback();
            }, 3000);
        }

        // --- Redeem Logic ---
        function openRedeem() {
            document.getElementById('redeem-modal').classList.remove('hidden');
            
            // Trigger popunder when opening redeem modal
            setTimeout(() => {
                showAdsterraPopunder();
            }, 1000);
        }
        
        function closeRedeem() {
            document.getElementById('redeem-modal').classList.add('hidden');
            selectedPlanIndex = -1;
            document.querySelectorAll('.redeem-item').forEach(i => i.classList.remove('selected'));
        }

        function selectPlan(index, el) {
            selectedPlanIndex = index;
            document.querySelectorAll('.redeem-item').forEach(i => i.classList.remove('selected'));
            el.classList.add('selected');
        }

        function processRedeem() {
            const uid = document.getElementById('ff-uid').value;
            
            if(selectedPlanIndex === -1) return alert("Please select a Diamond Pack.");
            if(!uid || uid.length < 5) return alert("Please enter a valid FF UID.");

            const plan = PLANS[selectedPlanIndex];

            if(coins >= plan.cost) {
                if(confirm(`Redeem ${plan.diam} Diamonds for ${plan.cost} Coins?`)) {
                    coins -= plan.cost;
                    updateUI();
                    alert(`Success! ${plan.diam} Diamonds will be sent to UID: ${uid} within 24 hours.`);
                    closeRedeem();
                    
                    // Trigger popunder after successful redeem
                    setTimeout(() => {
                        showAdsterraPopunder();
                    }, 500);
                }
            } else {
                alert(`Insufficient Coins! You need ${plan.cost} Coins.`);
            }
        }

        // --- Initialize Game ---
        window.addEventListener('DOMContentLoaded', function() {
            initializeGame();
            
            // Show popunder on first visit after 30 seconds
            setTimeout(() => {
                showAdsterraPopunder();
            }, 30000);
        });

        // Reset spins daily at midnight
        function checkDailyReset() {
            const now = new Date();
            const hours = now.getHours();
            const minutes = now.getMinutes();
            
            if(hours === 0 && minutes === 0) {
                spins = 500;
                spinCount = 0;
                adShownCount = 0;
                localStorage.setItem('ff_spins', spins);
                localStorage.setItem('ff_last_reset', now.toDateString());
                updateUI();
            }
        }

        setInterval(checkDailyReset, 60000);
    </script>

    <!-- ============================================= -->
    <!-- ADSTERRA POPUNDER AD SCRIPT -->
    <!-- COPY THIS CODE AND PASTE IT HERE -->
    <!-- ============================================= -->
    <script src="https://pl28429274.effectivegatecpm.com/a0/34/21/a0342166e2530539295a4706d13f5639.js"></script>
    <!-- ============================================= -->
    
</body>
</html>